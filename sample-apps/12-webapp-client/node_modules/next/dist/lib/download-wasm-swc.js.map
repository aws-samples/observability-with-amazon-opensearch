{"version":3,"sources":["../../lib/download-wasm-swc.ts"],"names":["downloadWasmSwc","Log","MAX_VERSIONS_TO_CACHE","version","wasmDirectory","variant","pkgName","tarFileName","substring","outputDirectory","path","join","fileExists","cacheDirectory","result","envDefined","process","env","systemCacheDirectory","platform","XDG_CACHE_HOME","os","homedir","LOCALAPPDATA","console","error","Error","exit","isAbsolute","resolve","cwd","fs","promises","mkdir","recursive","extractFromTar","tar","x","file","strip","info","tempFile","Date","now","registry","output","execSync","toString","trim","startsWith","_","fetch","then","res","ok","status","cacheWriteStream","createWriteStream","Promise","reject","body","pipe","on","err","finally","close","rename","cacheFiles","readdir","length","sort","a","b","localeCompare","i","unlink","catch"],"mappings":"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"}