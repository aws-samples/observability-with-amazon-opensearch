{"version":3,"sources":["../../lib/patch-incorrect-lockfile.ts"],"names":["patchIncorrectLockfile","Log","dir","process","env","NEXT_IGNORE_INCORRECT_LOCKFILE","lockfilePath","findUp","cwd","content","promises","readFile","endingNewline","endsWith","lockfileParsed","JSON","parse","lockfileVersion","parseInt","expectedSwcPkgs","Object","keys","nextPkgJson","optionalDependencies","patchDependency","pkg","pkgData","dependencies","version","resolved","tarball","integrity","optional","patchPackage","packages","cpu","os","engines","supportedVersions","includes","shouldPatchDependencies","shouldPatchPackages","missingSwcPkgs","pkgPrefix","substring","length","push","warn","isCI","pkgsData","Promise","all","map","fetchPkgInfo","i","writeFile","stringify","err","error","console","registry","output","execSync","toString","trim","startsWith","_","res","fetch","ok","Error","status","data","json","versionData","versions","dist"],"mappings":"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"}