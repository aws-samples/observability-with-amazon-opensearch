{"version":3,"sources":["../../../../server/lib/incremental-cache/file-system-cache.ts"],"names":["FileSystemCache","constructor","ctx","fs","flushToDisk","serverDistDir","maxMemoryCacheSize","memoryCache","LRUCache","max","length","value","kind","JSON","stringify","props","Error","html","pageData","get","key","data","htmlPath","getFsPath","readFile","parse","mtime","stat","lastModified","getTime","set","_","Date","now","mkdir","path","dirname","writeFile","pathname","join"],"mappings":"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"}