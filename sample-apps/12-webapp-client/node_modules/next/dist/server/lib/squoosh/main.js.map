{"version":3,"sources":["../../../../server/lib/squoosh/main.ts"],"names":["processBuffer","decodeBuffer","path","getWorker","execOnce","Worker","resolve","__dirname","enableWorkerThreads","numWorkers","Math","max","min","cpus","length","computeWorkerKey","method","buffer","operations","encoding","quality","worker","imageData","operation","type","rotate","numRotations","width","resize","image","height","Buffer","from","encodeJpeg","encodeWebp","avifQuality","encodeAvif","encodePng","Error"],"mappings":"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"}