{"version":3,"sources":["../../server/web-server.ts"],"names":["NextWebServer","BaseServer","constructor","options","Object","assign","renderOpts","webServerConfig","extendRenderOpts","generateRewrites","beforeFiles","afterFiles","fallback","handleCompression","getRoutesManifest","headers","rewrites","redirects","getPagePath","getPublicDir","getBuildId","serverOptions","buildId","loadEnvConfig","getHasStaticDir","generateImageRoutes","generateStaticRoutes","generateFsStaticRoutes","generatePublicRoutes","generateCatchAllMiddlewareRoute","getFontManifest","undefined","getPagesManifest","page","getAppPathsManifest","getFilesystemPaths","Set","getPrerenderManifest","version","routes","dynamicRoutes","notFoundRoutes","preview","previewModeId","previewModeSigningKey","previewModeEncryptionKey","getServerComponentManifest","renderHTML","req","_res","pathname","query","renderToHTML","url","cookies","disableOptimizedLoading","runtime","sendRenderResult","_req","res","setHeader","poweredByHeader","type","getHeader","result","isDynamic","writer","transformStream","writable","getWriter","pipe","write","chunk","end","close","destroy","err","abort","cork","uncork","payload","toUnchunkedString","String","byteLength","generateEtags","generateETag","body","send","runApi","findPageComponents","params","loadComponent","components"],"mappings":"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"}